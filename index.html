<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movistar Premium | Gestión de Portabilidad</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        movistar: { blue: '#019DF0', dark: '#005A87', green: '#5BC500', slate: '#1E293B' }
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 5s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-8px)' },
                        }
                    }
                }
            }
        }
    </script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.3); }
        .stage-container { display: none; }
        .stage-container.active { display: block; animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Checkbox/Radio */
        .selector-card:checked + div {
            border-color: #019DF0;
            background-color: #f0f9ff;
            box-shadow: 0 10px 15px -3px rgba(1, 157, 240, 0.2);
        }
    </style>
</head>
<body class="antialiased text-slate-900">

    <div id="toast-container" class="fixed top-5 right-5 z-[9999] flex flex-col gap-3"></div>

    <header class="glass sticky top-0 z-50 shadow-sm border-b">
        <div class="container mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer" onclick="location.reload()">
                <div class="w-10 h-10 bg-movistar-blue rounded-xl flex items-center justify-center shadow-lg shadow-blue-200">
                    <i class="fas fa-mobile-alt text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="font-extrabold text-xl tracking-tight leading-none">Movistar <span class="text-movistar-blue">Elite</span></h1>
                    <p class="text-[10px] uppercase tracking-[0.2em] font-bold text-slate-400">Portal de Portabilidad</p>
                </div>
            </div>
            <div class="hidden md:flex items-center gap-6">
                <div class="flex items-center gap-2 text-xs font-bold text-slate-500 bg-slate-100 px-4 py-2 rounded-full">
                    <span class="w-2 h-2 bg-movistar-green rounded-full animate-pulse"></span> Servidor Encriptado SSL
                </div>
            </div>
        </div>
    </header>

    <main class="py-8 md:py-12">
        
        <div class="container mx-auto px-6 mb-12">
            <div class="flex items-center justify-center max-w-3xl mx-auto gap-4">
                <div class="step-dot w-3 h-3 rounded-full bg-movistar-blue" id="dot-1"></div>
                <div class="h-1 flex-1 bg-slate-200 rounded-full overflow-hidden"><div id="bar-1" class="h-full bg-movistar-blue w-0 transition-all duration-500"></div></div>
                <div class="step-dot w-3 h-3 rounded-full bg-slate-200" id="dot-2"></div>
                <div class="h-1 flex-1 bg-slate-200 rounded-full overflow-hidden"><div id="bar-2" class="h-full bg-movistar-blue w-0 transition-all duration-500"></div></div>
                <div class="step-dot w-3 h-3 rounded-full bg-slate-200" id="dot-3"></div>
            </div>
        </div>

        <section id="stage-1" class="stage-container active px-6">
            <div class="max-w-xl mx-auto glass rounded-[2.5rem] p-8 md:p-12 shadow-2xl shadow-blue-900/5 border border-white">
                <div class="text-center mb-10">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-blue-50 text-movistar-blue rounded-3xl mb-6 animate-float">
                        <i class="fas fa-sync-alt text-3xl"></i>
                    </div>
                    <h2 class="text-3xl font-extrabold text-slate-800 tracking-tight mb-2">Inicia tu Portabilidad</h2>
                    <p class="text-slate-500 font-medium">Mantén tu número de siempre y estrena el mejor equipo con precio de liquidación.</p>
                </div>

                <form id="form-val" class="space-y-6">
                    <div>
                        <label class="block text-xs font-extrabold uppercase tracking-widest text-slate-400 mb-2 ml-1">Número a Portar (10 dígitos)</label>
                        <div class="relative">
                            <i class="fas fa-phone absolute left-5 top-1/2 -translate-y-1/2 text-slate-300"></i>
                            <input type="tel" id="val-phone" required pattern="[0-9]{10}" placeholder="Ej. 4141234567" 
                                class="w-full bg-slate-50 border-2 border-slate-100 py-4 pl-14 pr-6 rounded-2xl text-xl font-bold focus:border-movistar-blue focus:bg-white transition-all outline-none">
                        </div>
                    </div>
                    <button type="submit" class="w-full bg-movistar-blue hover:bg-movistar-dark text-white font-extrabold py-5 rounded-2xl shadow-xl shadow-blue-500/30 transition-all transform hover:scale-[1.02] active:scale-95 flex items-center justify-center gap-3">
                        VER EQUIPOS DISPONIBLES <i class="fas fa-chevron-right text-sm"></i>
                    </button>
                </form>
            </div>
        </section>

        <section id="stage-2" class="stage-container px-6">
            <div class="container mx-auto max-w-7xl">
                <div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-6">
                    <div>
                        <h2 class="text-4xl font-extrabold text-slate-800 tracking-tighter italic">REMATES 2026</h2>
                        <p class="text-slate-500 font-semibold">Equipos nuevos garantizados para portabilidad inmediata.</p>
                    </div>
                    <div class="w-full md:w-96 relative">
                        <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                        <input type="text" id="searchInput" placeholder="Buscar equipo (ZTE, iPhone, Samsung...)" 
                            class="w-full bg-white py-4 pl-12 pr-6 rounded-2xl border-none shadow-md focus:ring-2 ring-movistar-blue transition-all">
                    </div>
                </div>
                <div id="device-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
            </div>
        </section>

        <section id="stage-3" class="stage-container px-6">
            <div class="container mx-auto max-w-6xl">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
                    
                    <div class="lg:col-span-4 space-y-6">
                        <div class="glass rounded-[2rem] p-8 text-center relative overflow-hidden">
                            <div class="absolute top-4 right-4 bg-movistar-green text-white text-[10px] font-black px-3 py-1 rounded-full animate-pulse">STOCK DISPONIBLE</div>
                            <img id="c-img" src="" class="h-64 mx-auto object-contain mb-6 drop-shadow-2xl">
                            <h3 id="c-name" class="text-2xl font-black text-slate-800 italic uppercase leading-none"></h3>
                            <p id="c-brand" class="text-movistar-blue font-bold tracking-[0.3em] text-[10px] mt-2"></p>
                        </div>
                        
                        <div class="bg-slate-800 rounded-[2rem] p-8 text-white">
                            <h4 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-4 italic">Resumen de Pago</h4>
                            <div class="space-y-4">
                                <div class="flex justify-between text-sm">
                                    <span class="text-slate-400">Precio de Liquidación:</span>
                                    <span id="res-price" class="font-bold"></span>
                                </div>
                                <div class="flex justify-between text-sm">
                                    <span class="text-slate-400">Plan Seleccionado:</span>
                                    <span id="res-plan" class="font-bold"></span>
                                </div>
                                <div class="pt-4 border-t border-slate-700 flex justify-between items-end">
                                    <div>
                                        <p class="text-[10px] text-movistar-green font-black">PAGO MENSUAL ESTIMADO</p>
                                        <p id="res-monthly" class="text-3xl font-black text-white">$0.00</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-[10px] text-slate-400 font-black">PAGO INICIAL</p>
                                        <p id="res-total" class="text-xl font-black text-movistar-blue"></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="lg:col-span-8 glass rounded-[2.5rem] p-8 md:p-12 shadow-xl">
                        <form id="final-form" class="space-y-10">
                            <div class="space-y-4">
                                <h4 class="text-sm font-black uppercase tracking-widest text-movistar-blue flex items-center gap-2">
                                    <i class="fas fa-calendar-alt"></i> 1. Selecciona el plazo de financiamiento
                                </h4>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <label class="cursor-pointer">
                                        <input type="radio" name="term" value="3" class="selector-card sr-only" checked onchange="App.updateQuote()">
                                        <div class="border-2 border-slate-100 p-4 rounded-2xl text-center transition-all">
                                            <p class="text-lg font-black">3 Meses</p>
                                            <p class="text-[10px] text-slate-400 font-bold">Sin intereses</p>
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="term" value="6" class="selector-card sr-only" onchange="App.updateQuote()">
                                        <div class="border-2 border-slate-100 p-4 rounded-2xl text-center transition-all">
                                            <p class="text-lg font-black">6 Meses</p>
                                            <p class="text-[10px] text-slate-400 font-bold">Plan Preferente</p>
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="term" value="12" class="selector-card sr-only" onchange="App.updateQuote()">
                                        <div class="border-2 border-slate-100 p-4 rounded-2xl text-center transition-all">
                                            <p class="text-lg font-black">12 Meses</p>
                                            <p class="text-[10px] text-slate-400 font-bold">Cuotas Fijas</p>
                                        </div>
                                    </label>
                                    <label class="cursor-pointer">
                                        <input type="radio" name="term" value="24" class="selector-card sr-only" onchange="App.updateQuote()">
                                        <div class="border-2 border-slate-100 p-4 rounded-2xl text-center transition-all">
                                            <p class="text-lg font-black">24 Meses</p>
                                            <p class="text-[10px] text-slate-400 font-bold">Mensualidad Mínima</p>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <div class="space-y-4 pt-6 border-t border-slate-100">
                                <h4 class="text-sm font-black uppercase tracking-widest text-movistar-blue flex items-center gap-2">
                                    <i class="fas fa-user-check"></i> 2. Información del Titular
                                </h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <input type="text" id="f-name" required placeholder="Nombre Completo" class="w-full bg-slate-50 p-4 rounded-xl border-none ring-1 ring-slate-200 focus:ring-2 ring-movistar-blue transition-all font-bold">
                                    <input type="text" id="f-id" required placeholder="Cédula / Identificación" class="w-full bg-slate-50 p-4 rounded-xl border-none ring-1 ring-slate-200 focus:ring-2 ring-movistar-blue transition-all font-bold">
                                </div>
                                <textarea id="f-address" required placeholder="Dirección detallada para entrega del equipo..." rows="2" class="w-full bg-slate-50 p-4 rounded-xl border-none ring-1 ring-slate-200 focus:ring-2 ring-movistar-blue transition-all font-bold resize-none"></textarea>
                            </div>

                            <button type="submit" class="w-full bg-movistar-green hover:bg-[#4ea800] text-white font-black py-6 rounded-2xl shadow-xl shadow-green-500/20 text-lg uppercase italic tracking-wider flex items-center justify-center gap-4 transition-all transform hover:-translate-y-1">
                                FINALIZAR Y ENVIAR POR WHATSAPP <i class="fab fa-whatsapp text-2xl"></i>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <script>
        const WHATSAPP_NUMBER = "+584142799204";
        const mxn = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' });

        const db = [
            { id: 101, name: "Nubia Neo 3 GT 5G", brand: "ZTE", price: 1899, img: "https://placehold.co/400x400/1e293b/019DF0/png?text=Nubia+Neo+3+GT" },
            { id: 1, name: "iPhone 17 Pro Max", brand: "Apple", price: 5499, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/IPHONE/iPhone%2017%20Pro%20Max.jfif" },
            { id: 2, name: "Galaxy S24 Ultra", brand: "Samsung", price: 4999, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/SAMGMUG/s%2024%20ultra.jfif" },
            { id: 6, name: "iPhone 17 Normal", brand: "Apple", price: 3499, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/IPHONE/iPhone%2017.jfif" },
            { id: 7, name: "Xiaomi 13T Pro", brand: "Xiaomi", price: 2899, img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/XIAOMI/Xiaomi%2013T%20Pro.jfif" }
        ];

        const App = {
            state: { stage: 1, phone: '', device: null, planPrice: 100 },

            init() {
                document.getElementById('form-val').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.state.phone = document.getElementById('val-phone').value;
                    this.showToast('Número validado. Cargando catálogo...', 'info');
                    this.goTo(2);
                });

                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.renderCatalog(e.target.value);
                });

                document.getElementById('final-form').addEventListener('submit', this.sendToWhatsapp.bind(this));
                this.renderCatalog();
            },

            goTo(stage) {
                this.state.stage = stage;
                document.querySelectorAll('.stage-container').forEach(s => s.classList.remove('active'));
                document.getElementById(`stage-${stage}`).classList.add('active');
                
                // Actualizar Stepper UI
                if(stage >= 1) { 
                    document.getElementById('bar-1').style.width = stage >= 2 ? '100%' : '0%'; 
                    document.getElementById('dot-2').classList.replace('bg-slate-200', stage >= 2 ? 'bg-movistar-blue' : 'bg-slate-200');
                }
                if(stage >= 2) { 
                    document.getElementById('bar-2').style.width = stage >= 3 ? '100%' : '0%'; 
                    document.getElementById('dot-3').classList.replace('bg-slate-200', stage >= 3 ? 'bg-movistar-blue' : 'bg-slate-200');
                }
                window.scrollTo({top: 0, behavior: 'smooth'});
            },

            renderCatalog(filter = '') {
                const grid = document.getElementById('device-grid');
                const filtered = db.filter(d => d.name.toLowerCase().includes(filter.toLowerCase()));
                
                grid.innerHTML = filtered.map(d => `
                    <div onclick="App.selectDevice(${d.id})" class="glass p-5 rounded-[2rem] cursor-pointer hover:shadow-2xl transition-all group border-2 border-transparent hover:border-movistar-blue">
                        <img src="${d.img}" class="h-40 mx-auto object-contain mb-4 group-hover:scale-110 transition-transform">
                        <p class="text-[9px] font-black text-movistar-blue tracking-widest uppercase">${d.brand}</p>
                        <h4 class="font-bold text-slate-800 text-sm italic uppercase">${d.name}</h4>
                        <p class="text-xl font-black mt-2 text-slate-900">${mxn.format(d.price)}</p>
                        <div class="mt-4 py-2 bg-slate-100 rounded-xl text-center text-[10px] font-black text-slate-500 group-hover:bg-movistar-blue group-hover:text-white transition-colors">SELECCIONAR</div>
                    </div>
                `).join('');
            },

            selectDevice(id) {
                this.state.device = db.find(d => d.id === id);
                const d = this.state.device;
                document.getElementById('c-img').src = d.img;
                document.getElementById('c-name').innerText = d.name;
                document.getElementById('c-brand').innerText = d.brand;
                this.updateQuote();
                this.goTo(3);
            },

            updateQuote() {
                const d = this.state.device;
                const term = parseInt(document.querySelector('input[name="term"]:checked').value);
                const totalInicial = d.price + this.state.planPrice;
                const monthly = (d.price / term) + (this.state.planPrice / (term > 1 ? 1 : 1)); // Lógica simplificada

                document.getElementById('res-price').innerText = mxn.format(d.price);
                document.getElementById('res-plan').innerText = mxn.format(this.state.planPrice);
                document.getElementById('res-total').innerText = mxn.format(totalInicial);
                document.getElementById('res-monthly').innerText = mxn.format(monthly);
            },

            showToast(msg, type) {
                const toast = document.createElement('div');
                toast.className = `bg-slate-800 text-white px-6 py-4 rounded-2xl shadow-2xl text-sm font-bold animate-bounce`;
                toast.innerHTML = `<i class="fas fa-info-circle text-movistar-blue mr-2"></i> ${msg}`;
                document.getElementById('toast-container').appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            },

            sendToWhatsapp(e) {
                e.preventDefault();
                const d = this.state.device;
                const name = document.getElementById('f-name').value;
                const id = document.getElementById('f-id').value;
                const addr = document.getElementById('f-address').value;
                const term = document.querySelector('input[name="term"]:checked').value;
                const folio = 'MOV-' + Math.random().toString(36).substr(2, 9).toUpperCase();

                const message = `*SOLICITUD DE PORTABILIDAD MOVISTAR*%0A` +
                                `-----------------------------------%0A` +
                                `*Folio:* ${folio}%0A` +
                                `*Cliente:* ${name}%0A` +
                                `*ID:* ${id}%0A` +
                                `*Número a Portar:* ${this.state.phone}%0A` +
                                `-----------------------------------%0A` +
                                `*Equipo:* ${d.name}%0A` +
                                `*Precio Liquidación:* ${mxn.format(d.price)}%0A` +
                                `*Plazo Diferido:* ${term} Meses%0A` +
                                `*Plan Promocional:* ${mxn.format(this.state.planPrice)}%0A` +
                                `-----------------------------------%0A` +
                                `*Dirección de Envío:* ${addr}%0A` +
                                `-----------------------------------%0A` +
                                `_Enviado desde el Portal de Portabilidad Elite_`;

                window.open(`https://api.whatsapp.com/send?phone=${WHATSAPP_NUMBER.replace('+', '')}&text=${message}`, '_blank');
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
